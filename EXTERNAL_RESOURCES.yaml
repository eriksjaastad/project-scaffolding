# External Resources & Services
# Purpose: Track which external services, APIs, and resources are used across all projects
# Last Updated: 2026-01-06

metadata:
  purpose: "Track external services and costs across all projects"
  last_updated: "2026-01-07"
  why_exists: "When you get a bill or notification, you need to know which project uses that service"

# PROJECT SERVICE USAGE
# This is the main data structure - parsed by project-tracker dashboard
projects:
  project-scaffolding:
    monthly_cost: 5
    credential_file: ".env"
    services:
      - name: DeepSeek
        purpose: "Logic drafting"
        type: ai
        env_var: "SCAFFOLDING_DEEPSEEK_KEY"
        cost: 0.27
      - name: Discord
        purpose: "Governance alerts"
        type: notifications
        env_var: "SCAFFOLDING_DISCORD_WEBHOOK_URL"
        cost: 0
      - name: OpenAI
        purpose: "Model comparisons"
        type: ai
        env_var: "SCAFFOLDING_OPENAI_KEY"
        cost: 4
      - name: Anthropic
        purpose: "Architectural reviews"
        type: ai
        env_var: "SCAFFOLDING_ANTHROPIC_KEY"
        cost: 2

  trading-copilot:
    monthly_cost: 12
    credential_file: ".env"
    services:
      - name: Railway
        purpose: "hosting + Postgres"
        type: hosting
        env_var: "TRADING_RAILWAY_API_KEY"
        cost: 5
      - name: OpenAI
        purpose: "GPT-4o, 4o-mini, o1"
        type: ai
        env_var: "TRADING_OPENAI_API_KEY"
        cost: 4
      - name: Anthropic
        purpose: "Claude Opus 4, Sonnet 4, Haiku 3.5"
        type: ai
        env_var: "TRADING_ANTHROPIC_API_KEY"
        cost: 2
      - name: Google AI
        purpose: "Gemini 2.0/2.5 Flash"
        type: ai
        env_var: "TRADING_GOOGLE_AI_KEY"
        cost: 1
      - name: xAI
        purpose: "Grok-3"
        type: ai
        env_var: "TRADING_XAI_KEY"
        cost: 0.50
      - name: Discord
        purpose: "Webhooks for daily briefings"
        type: notifications
        env_var: "TRADING_DISCORD_WEBHOOK_URL"
        cost: 0
      - name: Healthchecks.io
        purpose: "Cron job monitoring"
        type: monitoring
        env_var: "TRADING_HEALTHCHECKS_KEY"
        cost: 0

  cortana-personal-ai:
    monthly_cost: 0.60
    credential_file: ".env"
    services:
      - name: OpenAI
        purpose: "gpt-4o-mini"
        type: ai
        env_var: "CORTANA_OPENAI_API_KEY"
        cost: 0.60
      - name: Discord
        purpose: "Daily update notifications"
        type: notifications
        env_var: "DISCORD_WEBHOOK_URL"
        cost: 0
        added: "2026-01-10"
        notes: "Added after 22-day silent failure incident"
      - name: SuperWhisper
        purpose: "Voice-to-text (one-time purchase)"
        type: local
        cost: 0
      - name: Wispr Flow
        purpose: "Voice dictation (one-time purchase)"
        type: local
        cost: 0

  image-workflow:
    monthly_cost: 10
    credential_file: ".env"
    services:
      - name: OpenAI
        purpose: "Batch processing, quality filtering"
        type: ai
        env_var: "IMAGE_WORKFLOW_OPENAI_API_KEY"
        cost: 10
      - name: Google Drive
        purpose: "Offsite backups via rclone"
        type: storage
        env_var: "IMAGE_WORKFLOW_RCLONE_CONFIG"
        cost: 0
      - name: rclone
        purpose: "Backup tool"
        type: local
        cost: 0

  3d-pose-factory:
    monthly_cost: 7
    credential_file: ".env"
    aliases: ["Image Generation", "Fat AI", "3D Renders", "Mission Control"]
    services:
      - name: Cloudflare R2
        purpose: "S3-compatible storage for pose outputs"
        type: storage
        env_var: "POSE_FACTORY_CLOUDFLARE_R2_KEY"
        cost: 7
      - name: rclone
        purpose: "Sync tool for R2"
        type: local
        cost: 0
      - name: RunPod
        purpose: "GPU Hosting for high-volume image generation"
        type: hosting
        env_var: "POSE_FACTORY_RUNPOD_API_KEY"
        cost: "Pay-per-use"

  project-tracker:
    monthly_cost: 0
    services:
      - name: SQLite
        purpose: "Local database"
        type: database
        cost: 0
      - name: FastAPI
        purpose: "Local web server"
        type: local
        cost: 0
    notes: "100% local, no external services"

  muffinpanrecipes:
    monthly_cost: 12
    credential_file: ".env"
    services:
      - name: Vercel
        purpose: "Site hosting"
        type: hosting
        env_var: "MUFFIN_VERCEL_TOKEN"
        cost: 0
      - name: Stability AI
        purpose: "High-end photography generation"
        type: ai
        env_var: "MUFFIN_STABILITY_API_KEY"
        cost: "Pay-per-use + $12/mo sub"
      - name: RunPod
        purpose: "GPU processing"
        type: hosting
        env_var: "MUFFIN_RUNPOD_API_KEY"
        cost: "Pay-per-use"

# SERVICES BY FUNCTION
# Purpose: Prevent signing up for duplicate services
services_by_function:
  ai_apis:
    - OpenAI (GPT-4o, 4o-mini, o1)
    - Stability AI (SDXL, SD 1.6)
    - Anthropic (Claude Opus 4, Sonnet 4, Haiku 3.5)
    - Google AI (Gemini 2.0/2.5 Flash)
    - xAI (Grok-3)
  
  hosting:
    - Railway (Python cron jobs + Postgres)
  
  storage:
    - Cloudflare R2 (S3-compatible)
    - Google Drive (via rclone)
  
  databases:
    - PostgreSQL (Railway)
    - SQLite (local)
  
  monitoring:
    - Discord Webhooks
    - Healthchecks.io
  
  voice_to_text:
    - SuperWhisper (local)
    - Wispr Flow (local)
  
  tools:
    - rclone (cloud sync)

# API KEY MANAGEMENT PATTERN
api_key_pattern:
  rule: "Each project manages its own API keys - NEVER share across projects"
  format: "{project-name}-{service} → {project}/.env"
  template: "{PROJECTS_ROOT}/.env.project-template"
  naming_rule: "PREFIX_SERVICE_TYPE"
  examples:
    - "SCAFFOLDING_DEEPSEEK_KEY → project-scaffolding/.env"
    - "CORTANA_OPENAI_KEY → cortana-personal-ai/.env"
    - "TRADING_OPENAI_KEY → trading-copilot/.env"
  why:
    - "Cost attribution (which project spent what?)"
    - "Failure isolation (one project's rate limit doesn't affect others)"
    - "Security isolation (compromise one → others safe)"
    - "Clear ownership (each project pays for itself)"

# COST SUMMARY
cost_summary:
  infrastructure: 5  # Railway
  ai_apis: 18  # Variable 15-20
  total_known: 23  # $20-25/month
  total_unknown: 0  # Need audits for some projects

# REJECTED/UNUSED SERVICES
# Purpose: Don't re-sign up for things we already tried
rejected_services: []

cancelled_accounts: []

# ACTION ITEMS
action_items:
  immediate:
    - "✅ Decentralize .env files using global template"
    - "Audit for orphaned accounts (check email, credit card, password manager)"
  
  this_week:
    - "Migrate individual project keys to their respective .env files"
    - "Audit 3d-pose-factory resources"
    - "Audit Hypocrisy Now resources"
  
  ongoing:
    - "Update this file when adding new services"
    - "Monthly cost review (end of each month)"
    - "Clean up unused accounts"
    - "Document credential locations"

# WHEN YOU GET A BILL/NOTIFICATION
emergency_response:
  - "Check this file - See which project uses the service"
  - "Update cost if changed - Keep estimates current"
  - "Verify still needed - Cancel if not being used"
  - "Document any issues - Add notes"

# BEFORE ADDING A NEW SERVICE
before_adding_service:
  checklist:
    - "Do we already have something that does this? (Check services_by_function)"
    - "Have we tried this before? (Check rejected_services)"
    - "Which project needs this? (Document immediately)"
    - "What's the cost? (Know before committing)"
    - "Can we use existing service instead? (Avoid proliferation)"
  
  steps_to_add:
    - "Check services_by_function - avoid duplicates"
    - "Check rejected_services - don't retry failures"
    - "Add to projects section above with env_var name"
    - "Add to services_by_function category"
    - "Update cost_summary"
    - "Document credential location"
    - "Update metadata.last_updated"

# SECURITY NOTES
security:
  policy: "Decentralized Project-Specific Keys"
  template_source: "{PROJECTS_ROOT}/.env.project-template"
  credential_locations:
    - "Each project: .env file (git-ignored)"
  
  good_practices:
    - "✅ All .env files in .gitignore"
    - "✅ Never committed to git"
    - "⚠️ Use global template for naming consistency"
    - "⚠️ Consider key rotation policy (every 6-12 months)"

# RECENT DISCOVERIES
recent_changes:
  - date: "2026-01-06"
    change: "Implemented decentralized environment variable system with global template"
  - date: "2025-12-31"
    change: "Converted to YAML format for better parsing"
